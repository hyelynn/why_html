<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART BY US</title>

    <!-- Bootstrap 4.3.1 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <!-- <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="js/jquery.ajax-cross-origin.min.js"></script> -->
    <!-- Custom -->
    <link rel="stylesheet" href="../css/custom.css">
    <script src="../js/custom.js"></script>

    <!-- Fontawesome -->
    <link rel="stylesheet" href="../css/fontawesome/css/all.min.css">
</head>

<body>
    <header include-html="include/header_sub.html"></header>

    <div class="py-md-3 px-5 py-2 text-center text-white bg-deep-dark top-notice">
        <span class="font-weight-light">코로나19에 대한 아트바이어스의 대책 및 환불 정책에 대한 최신 정보를 확인하세요.</span>
        <a href="#x" class="text-white d-lg-inline-block d-block">자세히 알아보기</a>
    </div>

    <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-1">
        <div class="container">
            <a class="navbar-brand" href="../index.html"><img src="../img/logo.png" srcset="../img/logo@2x.png 2x, ../img/logo@3x.png 3x"></a>
            <div class="ml-auto align-items-center d-lg-none d-flex">
                <a class="text-dark mr-3 font-size-sm" href="../member/calendar.html"><i class="far fa-calendar-alt"></i></a>
                <a class="text-dark mr-3 font-size-sm" href="../member/recent_list.html"><i class="far fa-clock"></i></a>
                <a class="text-dark mr-2 font-size-sm" href="../member/cart.html"><i class="fas fa-shopping-cart"></i></a>
            </div>
            <button class="navbar-toggler border-0 font-size-md text-dark" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <!-- <ul class="navbar-nav m-auto font-weight-light top-nav">
                    <li class="nav-item mx-lg-3 mx-2 active">
                        <a class="nav-link text-dark" href="#x">캘린더</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link text-dark" href="#x">최근 본 리스트</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link text-dark" href="#x">장바구니</a>
                    </li>
                </ul> -->

                <!-- user -->
                <ul class="navbar-nav border-top pt-3 m-lg-auto mt-2 font-size-xs d-block d-lg-none">
                    <!-- Login -->
                    <li class="nav-item mx-lg-3 mx-2 mb-2">
                        <button class="btn btn-block border text-dark dropdown-toggle p-2 bg-white rounded-xl" type="button" data-toggle="modal" data-target="#loginModal">
                            <span>로그인</span>
                        </button>
                    </li>

                    <!-- Login - user -->
                    <!--
                    <li class="nav-item mx-lg-3 mx-2 mb-2">
                        <div class="d-flex">
                            <div class="position-relative mr-2 nav-user-profile">
                                <span class="position-absolute rounded-pill bg-hot-pink nav-user-notify"></span>
                                <img src="../img/profile-photo@3x.jpg" class="rounded-circle nav-user-profile-img" alt="김민범님">
                            </div>
                            <span class="align-self-center">김민범</span>
                        </div>
                    </li>
                    -->

                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">예약 리스트</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">찜 리스트</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">나의 이용 후기</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">채팅</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="../member/chat_user.html">1:1 문의<span class="ml-2 d-inline-block rounded-pill align-top mt-1 bg-hot-pink nav-notify"></span></a>
                    </li>
                    <div class="dropdown-divider"></div>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">회원 정보 관리</a>
                    </li>
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link" href="#x">호스트 전환</a>
                    </li>

                    <!-- Login했을 때에만 출력 -->
                    <li class="nav-item mx-lg-3 mx-2">
                        <a class="nav-link text-hot-pink" href="#x">로그아웃</a>
                    </li>
                </ul>

                <!-- user - lg -->
                <ul class="navbar-nav ml-auto align-items-center d-none d-lg-flex">
                    <li class="nav-item mr-2 font-size-md">
                        <a class="nav-link text-dark" href="../member/calendar.html"><i class="far fa-calendar-alt"></i></a>
                    </li>
                    <li class="nav-item mr-2 font-size-md">
                        <a class="nav-link text-dark" href="../member/recent_list.html"><i class="far fa-clock"></i></a>
                    </li>
                    <li class="nav-item mr-3 font-size-md">
                        <a class="nav-link text-dark" href="../member/cart.html"><i class="fas fa-shopping-cart"></i></a>
                    </li>
                    <li class="nav-item">
                        <!-- Login -->
                        <button class="btn border text-dark dropdown-toggle bg-white rounded-xl" type="button" data-toggle="modal" data-target="#loginModal">
                            <span>로그인</span>
                        </button>

                        <!-- Login - user -->
                        <!--
                        <div class="dropdown">
                            <button class="btn border text-dark dropdown-toggle bg-white rounded-xl" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="d-flex">
                                    <div class="position-relative mr-2 nav-user-profile">
                                        <span class="position-absolute rounded-pill bg-hot-pink nav-user-notify"></span>
                                        <img src="img/profile-photo@3x.jpg" class="rounded-circle nav-user-profile-img" alt="김민범님">
                                    </div>
                                    <span>김민범</span>
                                </div>
                            </button>
                            <div class="dropdown-menu dropdown-menu-lg-right rounded-xl" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#x">예약 리스트</a>
                                <a class="dropdown-item" href="#x">찜 리스트</a>
                                <a class="dropdown-item" href="#x">나의 이용 후기</a>
                                <a class="dropdown-item" href="#x">채팅</a>
                                <a class="dropdown-item" href="../member/chat_user.html">1:1 문의<span class="ml-2 d-inline-block rounded-pill align-top mt-1 bg-hot-pink nav-notify"></span></a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#x">회원 정보 관리</a>
                                <a class="dropdown-item" href="#x">호스트 전환</a>
                                <a class="dropdown-item text-hot-pink" href="#x">로그아웃</a>
                            </div>
                        </div>
                        -->
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main role="main">
        <div class="container py-lg-5 py-4">
            <h3 class="mb-4">개인 회원가입</h3>
            <!-- form -->
            <div class="mb-2">
                <div class="custom-inputs-sub not mb-3">
                    <label for="user_id" class="d-block text-gray">아이디(이메일)</label>
                    <div class="d-flex">
                        <input type="text" class="form-control flex-fill mr-4" id="user_id" placeholder="example@example.com">
                        <button type="button" id="is_dup" class="btn flex-fill w-25 bg-yellow">중복확인</button>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="user_pw" class="d-block text-gray">비밀번호</label>
                        <input type="password" class="form-control" id="user_pw" placeholder="6~14자리 이상의 영문, 숫자">
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="user_pw2" class="d-block text-gray">비밀번호 확인</label>
                        <input type="password" class="form-control" id="user_pw2" placeholder="비밀번호 확인">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="user_name" class="d-block text-gray">이름</label>
                        <input type="text" class="form-control" id="user_name" placeholder="이름">
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="user_nickname" class="d-block text-gray">닉네임</label>
                        <input type="text" class="form-control" id="user_nickname" placeholder="아트바이어스">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="user_phone" class="d-block text-gray">연락처</label>
                        <div class="d-flex">
                            <div class="flex-fill mr-4">
                                <input type="text" class="form-control" id="user_phone" placeholder="010-1234-5678">
                            </div>
                            <button type="button" class="btn flex-fill w-25 bg-yellow">인증번호 발송</button>
                        </div>
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="user_auth" class="d-block text-gray">인증번호</label>
                        <input type="text" class="form-control" id="user_auth" placeholder="인증번호">
                    </div>
                </div>
            </div>

            <!-- checkbox -->
            <div class="d-flex mb-4 custom-inputs">
                <input type="checkbox" class="custom-checkbox mr-2" id="all_agree">
                <label for="all_agree" class="mb-0">
                    개인 회원 약관 및 개인정보이용방안을 이해하였으며 이에 동의합니다.
                    <a href="../sub/terms.html" class="text-dark" target="_blank">(보기)</a>
                </label>
            </div>

            <!-- button -->
            <div class="custom-inputs-sub not">
                <button type="button" id="signup" onClick="sendFormAjax();" class="btn btn-block bg-yellow">회원가입 완료</button>
            </div>
        </div>
    </main>

    <footer class="bg-light">
        <div class="container py-lg-5 py-4">
            <div class="d-lg-flex align-items-center justify-content-between mb-lg-4 mb-3">
                <a href="../index.html"><img src="../img/logo.png" srcset="../img/logo@2x.png 2x, ../img/logo@3x.png 3x"></a>
                <ul class="d-flex list-unstyled mb-0 font-weight-light footer-menu font-size-x mt-lg-0 mt-3">
                    <li class="px-md-2 px-1 position-relative"><a href="../sub/terms.html" class="text-muted text-decoration-none">이용약관</a></li>
                    <li class="px-md-2 px-1 position-relative"><a href="#x" class="text-muted text-decoration-none">서비스정보</a></li>
                    <li class="px-md-2 px-1 position-relative"><a href="../sub/board_notice.html" class="text-muted text-decoration-none">공지사항</a></li>
                    <li class="px-md-2 px-1 position-relative"><a href="#x" class="text-muted text-decoration-none">도움말</a></li>
                    <li class="px-md-2 px-1 position-relative"><a href="#x" class="text-muted text-decoration-none">광고신청하기</a></li>
                    <li class="px-md-2 px-1 position-relative"><a href="#x" class="text-muted text-decoration-none">호스트등록</a></li>
                </ul>
            </div>

            <div class="border-top text-muted font-weight-light pt-lg-4 pt-3 font-size-x">
                <p class="mb-0">상호명 : 아트바이어스<span class="text-divider"></span>대표 : 김사람<span class="text-divider"></span>사업자등록번호 : 123-45-67890<span class="text-divider"></span>통신판매업신고번호 : 2018-서울관악-12345<span class="text-divider"></span>
                    <a href="#x" class="text-dark text-decoration-none font-weight-normal">사업자등록정보 ></a></p>
                <p>영업소재지 : 서울특별시 강남구 테헤란로 123<span class="text-divider"></span>이메일 : info@artbyus.com<span class="text-divider"></span>대표전화 : 02-123-4567 (평일 오전 9시 ~ 오후 6시, 공휴일 제외)</p>

                <div class="d-lg-flex mb-3">
                    <a href="#x" class="text-dark text-decoration-none font-weight-normal mr-2">온라인 1:1문의 바로가기</a>
                    <span>(평일 2시 ~ 오후 6시) * 공간에 대한 문의사항은 해당 공간 호스트에게 직접 문의해 주세요.</span>
                </div>

                <p>아트바이어스는 통신판매중개자이며 통신판매의 당사자가 아닙니다. 따라서 아트바이어스는 공간 거래정보 및 거래에 대해 책임지지 않습니다.</p>
                <p class="text-right font-weight-light text-light-gray">Copyright ART BY US crop. All Right Reserved.</p>
            </div>
        </div>
    </footer>
    <script type="text/javascript">

    document.getElementById("is_dup").addEventListener('click', function(){
            var email =  document.getElementById("user_id").value;
            var regEmail = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
            if (!regEmail.test(email)) {
                alert('아이디가 형식에 맞지 않습니다'); 
                document.getElementById("user_id").focus();
                return false;
            }
            var xhr = new XMLHttpRequest();
    
            xhr.onreadystatechange = function() { 
                if (xhr.readyState === xhr.DONE) { 
                    if (xhr.status === 200 || xhr.status === 201) {
                        var result = JSON.parse(xhr.responseText);
                        if(result.result=="false"){
                            alert("이미 사용중인 아이디 입니다.");
                            document.getElementById("user_id").value = "";
                            document.getElementById("user_id").focus();
                        }
                        else{
                            alert("사용 할 수 있는 아이디 입니다.");
                        }
                    } else {
                    }
                }
                else{
                }
            };
            
            xhr.open('POST', 'http://3.34.150.116:3000/user/verify');
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send("email="+ email); 
        })

    function sendFormAjax(){
        if(CheckForm()){
            var user_id_t = document.getElementById("user_id").value;
            var user_pw_t = document.getElementById("user_pw").value;
            var user_name_t = document.getElementById("user_name").value;
            var user_nickname_t = document.getElementById("user_nickname").value;
            var user_phone_t = document.getElementById("user_phone").value;
            // var dataStuff = {
            //     user_id:user_id_t,
            //     user_pw:user_pw_t,
            //     user_name:user_name_t,
            //     user_nickname:user_nickname_t,
            //     user_phone:user_phone_t
            // }
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === xhr.DONE) { 
                    if (xhr.status === 200 || xhr.status === 201) {
                        alert(xhr.responseText);
                        window.location.href = "../index.html";
                    } else {
                        alert("회원가입이 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                        console.error(xhr.responseText);
                    }
                }else{
                }
            };
            xhr.open('POST', 'http://3.34.150.116:3000/user/apply',true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send("user_id="+user_id_t+"&user_pw="+user_pw_t+"&user_name="+user_name_t+"&user_nickname="+user_nickname_t+"&user_phone="+user_phone_t); 
            // xhr.send(dataStuff);
        }
            
    }
        
    //     document.getElementById("get_num").addEventListener('click', function(){
    //          console.log(Math.floor(Math.random() * 99999 + 1));
    //     })
     
    function CheckForm(){
        var user_id = document.getElementById("user_id").value;
        var user_pw = document.getElementById("user_pw").value;
        var user_pw2 = document.getElementById("user_pw2").value;
        var user_name = document.getElementById("user_name").value;
        var user_nickname = document.getElementById("user_nickname").value;
        var user_phone = document.getElementById("user_phone").value;
        var user_auth = document.getElementById("user_auth").value;
        var all_agree = document.getElementById("all_agree");

        var regEmail = /^[a-zA-Z0-9]+@[a-zA-Z0-9]+$/;
        var regPw = /^[A-Za-z0-9+]*$/;
        var regPhone = /^\d{2,3}-\d{3,4}-\d{4}$/;

        if(user_id == ""){
            alert("아이디를 입력해주세요.");
            document.getElementById("user_id").focus();
            return false;
        }
        if (!regEmail.test(document.getElementById('user_id').value)) {
             alert('아이디가 형식에 맞지 않습니다'); 
            document.getElementById("user_id").focus();
             return false;
        }
        if(user_pw == ""){
            alert("비밀번호를 입력해주세요.");
            document.getElementById("user_pw").focus();
            return false;
        }
        if(user_pw.length < 6 || user_pw.length > 14){
            alert("비밀번호는 6~14자리 입력해주세요.");
            document.getElementById("user_pw").focus();
            return false;
        }
        if (!regPw.test(document.getElementById('user_pw').value)) {
             alert('비밀번호가 형식에 맞지 않습니다'); 
            document.getElementById("user_pw").focus();
             return false;
        }
        if(user_pw2 == ""){
            alert("비밀번호 확인을 입력해주세요.");
            document.getElementById("user_pw2").focus();
            return false;
        }
        if(user_pw != user_pw2){
            alert("비밀번호가 서로 일치하지 않습니다.");
            document.getElementById("user_pw2").focus();
            return false;
        }
        if(user_name == ""){
            alert("이름을 입력해주세요.");
            document.getElementById("user_name").focus();
            return false;
        }
        if(user_nickname == ""){
            alert("닉네임을 입력해주세요.");
            document.getElementById("user_nickname").focus();
            return false;
        }
        if(user_phone == ""){
            alert("연락처를 입력해주세요.");
            document.getElementById("user_phone").focus();
            return false;
        }
        if (!regPhone.test(document.getElementById('user_phone').value)) {
             alert('전화번호가 형식에 맞지 않습니다'); 
            document.getElementById("user_phone").focus();
             return false;
        }
        if(user_auth == ""){
            alert("인증번호를 입력해주세요.");
            document.getElementById("user_auth").focus();
            return false;
        }
        if(user_auth != 1234){
            alert("인증번호가 맞지 않습니다.");
            document.getElementById("user_auth").focus();
            return false;
        }
        if(all_agree.checked){
            return true;
        }else{
            alert("동의를 해주세요.");
            return false;
        }
    }
    </script>
</body>

</html>