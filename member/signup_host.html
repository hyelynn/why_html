<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART BY US</title>

    <!-- Bootstrap 4.3.1 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
    <!-- Custom -->
    <link rel="stylesheet" href="/why_html/css/custom.css">
    <script src="/why_html/js/custom.js"></script>
    <script src="/why_html/js/upload.js"></script>
    <script src="/why_html/js/include.js"></script>
    <!-- Fontawesome -->
    <link rel="stylesheet" href="/why_html/css/fontawesome/css/all.min.css">

    <!-- Custom -->
    <script type="text/javascript" src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js" charset="utf-8"></script>
    <script src="/why_html/js/kakao_sdk.js"></script>

     <script>
         // SDK를 초기화 합니다. 사용할 앱의 JavaScript 키를 설정해 주세요.
         Kakao.init('d88bea310f4a39afbea3146fe1c0fa72');
         // SDK 초기화 여부를 판단합니다.
         console.log(Kakao.isInitialized());
     </script>
 
</head>

<body>
    <modal include-html="/why_html/include/header.html"></modal>
    <div class="py-md-3 px-5 py-2 text-center text-white bg-deep-dark top-notice">
        <span class="font-weight-light">코로나19에 대한 아트바이어스의 대책 및 환불 정책에 대한 최신 정보를 확인하세요.</span>
        <a href="#x" class="text-white d-lg-inline-block d-block">자세히 알아보기</a>
    </div>

    <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-1">
        <div class="container">
            <a class="navbar-brand" href="/why_html/index.html"><img src="http://artbyus.co.kr/why_html/img/logo.png"
                    srcset="http://artbyus.co.kr/why_html/img/logo@2x.png 2x, http://artbyus.co.kr/why_html/img/logo@3x.png 3x"></a>
            <div class="ml-auto align-items-center d-lg-none d-flex">
                <a class="text-dark mr-3 font-size-sm" href="/why_html/member/calendar.html"><i
                        class="far fa-calendar-alt"></i></a>
                <a class="text-dark mr-3 font-size-sm" href="/why_html/member/recent_list.html"><i
                        class="far fa-clock"></i></a>
                <a class="text-dark mr-2 font-size-sm" href="/why_html/member/purchase.html"><i
                        class="fas fa-shopping-cart"></i></a>
            </div>
            <button class="navbar-toggler border-0 font-size-md text-dark" type="button" data-toggle="collapse"
                data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarNavDropdown"></div>
        </div>
    </nav>
    <script src="/why_html/js/header.js"></script>

    <!-- Terms Modal -->
    <div class="modal fade custom-modal-full" id="termsModal" tabindex="-1" role="dialog" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <div class="modal-content">
                <div class="modal-body">
                    test
                </div>
            </div>
        </div>
    </div>

    <main role="main">
        <div class="container py-lg-5 py-4">
            <h3 class="mb-4">개인 회원가입</h3>
            <!-- form : 기본정보 -->
            <h5 class="mb-4">기본정보</h5>
            <div class="mb-4">
                <div class="custom-inputs-sub not mb-3">
                    <label for="host_id" class="d-block text-gray">아이디(이메일) <span class="d-block d-md-inline-block text-red font-size-xs">* 정산 정보와 예약 내역 등, 알림메일을 발송해 드립니다.</span></label>
                    <div class="d-flex">
                        <input type="text" class="form-control flex-fill mr-4" id="host_id" placeholder="example@example.com">
                        <button type="button" id="is_dup" class="btn flex-fill w-25 bg-yellow">중복확인</button>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="host_pw" class="d-block text-gray">비밀번호</label>
                        <input type="password" class="form-control" id="host_pw" placeholder="6~14자리 이상의 영문, 숫자">
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="host_pw2" class="d-block text-gray">비밀번호 확인</label>
                        <input type="password" class="form-control" id="host_pw2" placeholder="비밀번호 확인">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="host_name" class="d-block text-gray">이름</label>
                        <input type="text" class="form-control" id="host_name" placeholder="이름">
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="host_nickname" class="d-block text-gray">닉네임</label>
                        <input type="text" class="form-control" id="host_nickname" placeholder="아트바이어스">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="host_phone" class="d-block text-gray">연락처</label>
                        <div class="d-flex">
                            <div class="flex-fill mr-4">
                                <input type="text" class="form-control" id="host_phone" placeholder="010-1234-5678">
                            </div>
                            <button type="button" class="btn flex-fill w-25 bg-yellow">인증번호 발송</button>
                        </div>
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="host_auth" class="d-block text-gray">인증번호</label>
                        <input type="text" class="form-control" id="host_auth" placeholder="인증번호">
                    </div>
                </div>

                <label for="host_safe_no" class="d-block text-gray">안심번호입력</label>
                <div class="row align-items-center">
                    <div class="col-lg-6 custom-inputs-sub not">
                        <div class="d-flex">
                            <div class="flex-fill mr-lg-4 mr-2">
                                <input type="text" class="form-control" id="host_safe_no" placeholder="예) 0507-1234-5678">
                            </div>
                            <button type="button" class="btn flex-fill w-md-25 bg-yellow whitespace-nowrap">안심번호 생성</button>
                        </div>
                    </div>
                    <!--div class="col-lg-6">
                        <span class="text-red">잠시 후 다시 시도해 주세요.</span>
                        <span class="text-light-gray">사용할 수 있는 전화번호 입니다.</span>
                    </div-->
                </div>
            </div>

            <!-- form : 사업자정보 -->
            <h5 class="mb-4">사업자정보 입력</h5>
            <div class="mb-2">
                <div class="custom-inputs-sub mb-3">
                    <div class="d-lg-flex">
                        <div class="flex-fill w-25 mr-4">
                            <label for="host_type" class="d-block text-gray">사업자유형</label>
                            <select name="host_type" id="host_type" class="form-control">
                                <option value="">선택해 주세요.</option>
                                <option value="">간이과세자</option>
                                <option value="">일반과세자</option>
                                <option value="">법인사업자</option>
                                <option value="">면세사업자</option>
                                <option value="">기타사업자</option>
                            </select>
                        </div>
                        <div class="flex-fill w-75">
                            <label for="host_co_name" class="d-block text-gray">상호명</label>
                            <input type="text" class="form-control" id="host_co_name" placeholder="사업자등록증에 있는 상호명으로 입력해 주세요.">
                        </div>
                    </div>
                </div>
                <div class="custom-inputs-sub mb-3">
                    <div class="d-lg-flex">
                        <div class="flex-fill w-75 mr-4 mb-lg-0 mb-3">
                            <label for="host_no" class="d-block text-gray">사업자 등록번호</label>
                            <input type="text" class="form-control" id="host_no" placeholder="예) 123-45-67890">
                        </div>
                        <div class="flex-fill w-25">
                            <label for="host_ceo" class="d-block text-gray">대표자명</label>
                            <input type="text" class="form-control" id="host_ceo" placeholder="예) 홍길동">
                        </div>
                    </div>
                </div>
                <div class="custom-inputs-sub mb-3">
                    <label for="host_zipcode" class="d-block text-gray">사업장 주소</label>
                    <div class="d-lg-flex">
                        <input type="text" class="form-control flex-fill w-25 mr-4 mb-lg-0 mb-3" id="host_zipcode"  placeholder="우편번호">
                        <input type="text" class="form-control flex-fill w-75" id="host_address" placeholder="기본주소">
                    </div>
                    <input type="text" class="form-control mt-3" id="host_address2"  placeholder="상세주소">
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="host_sector" class="d-block text-gray">업종</label>
                        <input type="text" class="form-control" id="host_sector" placeholder="연습실">
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="host_sector2" class="d-block text-gray">업태</label>
                        <input type="text" class="form-control" id="host_sector2" placeholder="공간 공유업">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-6 custom-inputs-sub not mb-lg-0 mb-3">
                        <label for="host_bank" class="d-block text-gray">계좌 은행</label>
                        <select name="host_bank" id="host_bank" class="form-control">
                            <option value="">선택해 주세요.</option>
                            <option value="한국은행">한국은행</option>
                            <option value="부산은행">부산은행</option>
                            <option value="한국씨티은행">한국씨티은행</option>
                            <option value="대구은행">대구은행</option>
                            <option value="우체국">우체국</option>
                            <option value="하나은행">하나은행</option>
                            <option value="기업은행">기업은행</option>
                            <option value="전북은행">전북은행</option>
                            <option value="제주은행">제주은행</option>
                            <option value="카카오뱅크">카카오뱅크</option>
                            <option value="케이뱅크">케이뱅크</option>
                            <option value="산업은행">산업은행</option>
                            <option value="국민은행">국민은행</option>
                            <option value="외환은행">외환은행</option>
                            <option value="광주은행">광주은행</option>
                            <option value="경남은행">경남은행</option>
                            <option value="새마을금고">새마을금고</option>
                            <option value="농협">농협</option>
                            <option value="SC 제일은행">SC 제일은행</option>
                            <option value="신협 중앙회">신협 중앙회</option>
                            <option value="신한은행">신한은행</option>
                            <option value="수협중앙회">수협중앙회</option>
                            <option value="우리은행">우리은행</option>
                        </select>
                    </div>
                    <div class="col-lg-6 custom-inputs-sub not">
                        <label for="host_bank_account" class="d-block text-gray">예금주</label>
                        <input type="text" class="form-control" id="host_bank_account" placeholder="예금주">
                    </div>
                </div>
                <div class="custom-inputs-sub not mb-3">
                    <label for="host_bank_no" class="d-block text-gray">계좌번호</label>
                    <input type="text" class="form-control" id="host_bank_no" placeholder="예) 1234567890">
                </div>
                <form id="theForm" method="POST" enctype="multipart/form-data" >
                <div class="custom-inputs-sub not mb-4">
                    <span class="d-block mb-2 text-gray">사업자등록증 사본</span>
                    <div class="d-flex custom-file">
                        <input id="file_name" class="upload-name form-control flex-fill mr-4" placeholder="JPG, PNG 파일만 가능합니다.(파일이름은 “OOO사업자등록증” 으로 통일해 주세요)" disabled="disabled">
                        <label for="host_file" class="btn flex-fill w-25 mb-0 bg-yellow">업로드</label>
                        <input type="file" id="host_file" class="upload-hidden" onchange="addFile(this.files);">
                    </div>
                </div>
            </form>
            </div>


            <!-- checkbox -->
            <div class="d-flex mb-4 custom-inputs">
                <input type="checkbox" class="custom-checkbox mr-2" id="all_agree">
                <label for="all_agree" class="mb-0">
                    사업자 회원 약관 및 개인정보이용방안을 이해하였으며 이에 동의합니다.
                    <a href="../sub/terms.html#terms_host" class="text-dark" target="_blank">(보기)</a>
                </label>
            </div>

            <!-- button -->
            <div class="custom-inputs-sub not">
                <button type="button" id="send" onClick="sendFormAjax();" class="btn btn-block bg-yellow">사업자 회원가입 신청하기</button>
            </div>
        </div>
    </main>

    
    <footer include-html="../include/footer.html"></footer>
    <script>includeHTML();</script>
    <script>login_header();</script>
    <script src="/why_html/js/naver_login.js"></script>
    <script src="/why_html/js/login.js"></script>

<script type="text/javascript">
    var emailFlag = false;
    var albumBucketName = 'biz-cetificate';
    var bucketRegion = 'ap-northeast-2';
    var IdentityPoolId = 'ap-northeast-2:5de34811-ed49-42bb-8378-726186756855';

    AWS.config.update({
        region: bucketRegion,
        credentials: new AWS.CognitoIdentityCredentials({
            IdentityPoolId: IdentityPoolId
        })
    });

    var s3 = new AWS.S3({
        apiVersion: '2006-03-01',
        params: {Bucket: albumBucketName}
    });

    function addFile(albumName) {
        var files = document.getElementById('host_file').files;
        if (!files.length) {
            return alert('업로드할 파일을 선택해주세요.');
        }
        var file = files[0];
        var fileName = file.name;
        document.getElementById('file_name').value = fileName;
        // fileName = document.getElementById('host_id').value;
        var photoKey = fileName;
        s3.upload({
            Key: photoKey,
            Body: file,
            ACL: 'public-read'
        }, function(err, data) {
            if (err) {
                return alert('파일 업로드 실패: ', err, data);
                console.log(err, data);
            }
            alert('파일 업로드 성공');
            viewAlbum(albumName);
        });
    }

    
    document.getElementById("host_id").addEventListener('input', function(){
        emailFlag = false;
        document.getElementById("is_dup").disabled = false;
    });

    document.getElementById("is_dup").addEventListener('click', function(){
        var email =  document.getElementById("host_id").value;
        var regEmail = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
        if (!regEmail.test(email)) {
            alert('아이디가 형식에 맞지 않습니다'); 
            document.getElementById("host_id").focus();
            return false;
        }
        var xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function() { 
            if (xhr.readyState === xhr.DONE) { 
                if (xhr.status === 200 || xhr.status === 201) {
                    var result = JSON.parse(xhr.responseText);
                    if(result.result=="false"){
                        alert("이미 사용중인 아이디 입니다.");
                        document.getElementById("host_id").value = "";
                        document.getElementById("host_id").focus();
                    }
                    else{
                        alert("사용 할 수 있는 아이디 입니다.");
                        emailFlag = true;
                        document.getElementById("is_dup").disabled = true;
                    }
                } else {
                }
            }
            else{
            }
        };
        
        xhr.open('POST', 'http://3.34.150.116:3000/user/verify');
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send("email="+ email); 
    })
    
    function sendFormAjax(){
        if(CheckForm()){
        var host_id = document.getElementById("host_id").value;
        var host_pw = document.getElementById("host_pw").value;
        var host_name = document.getElementById("host_name").value;
        var host_nickname = document.getElementById("host_nickname").value;
        var host_phone = document.getElementById("host_phone").value;
        var host_type_sel = document.getElementById("host_type");
        var host_type = host_type_sel.options[host_type_sel.selectedIndex].value;
        var host_co_name = document.getElementById("host_co_name").value;
        var host_safe_no = document.getElementById("host_safe_no").value;
        var host_no = document.getElementById("host_no").value;
        var host_ceo = document.getElementById("host_ceo").value;
        var host_address = document.getElementById("host_address").value + " , " + document.getElementById("host_address2").value + " , " + document.getElementById("host_zipcode").value;
        var host_sector = document.getElementById("host_sector").value;
        var host_sector2 = document.getElementById("host_sector2").value;
        var host_bank_sel = document.getElementById("host_bank");
        var host_bank = host_bank_sel.options[host_bank_sel.selectedIndex].value;
        var host_bank_account = document.getElementById("host_bank_account").value;
        var host_bank_no = document.getElementById("host_bank_no").value;
        var files = document.getElementById('host_file').files;
        var host_file = files[0].name;
       
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === xhr.DONE) { 
                if (xhr.status === 200 || xhr.status === 201) {
                    alert("회원가입 완료");
                    window.location.href = "../index.html";
                } else {
                    alert("회원가입이 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                    console.error(xhr.responseText);
                }
            }else{
            }
        };
        xhr.open('POST', 'http://3.34.150.116:3000/host/apply');
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send("host_id="+host_id+"&host_pw="+host_pw+"&host_name="+host_name+"&host_nickname="+host_nickname+"&host_phone="+host_phone+"&host_safe_no="+host_safe_no
        +"&host_type="+host_type+"&host_co_name="+host_co_name+"&host_no="+host_no+"&host_ceo="+host_ceo+"&host_address="+host_address+"&host_sector="+host_sector
        +"&host_sector2="+host_sector2+"&host_bank="+host_bank+"&host_bank_account="+host_bank_account+"&host_bank_no="+host_bank_no+"&host_file="+host_file); 
    }
}
 
    function CheckForm(){
        var host_id = document.getElementById("host_id").value;
        var host_pw = document.getElementById("host_pw").value;
        var host_pw2 = document.getElementById("host_pw2").value;
        var host_name = document.getElementById("host_name").value;
        var host_nickname = document.getElementById("host_nickname").value;
        var host_phone = document.getElementById("host_phone").value;
        var host_auth = document.getElementById("host_auth").value;
        var host_safe_no = document.getElementById("host_safe_no").value;
        var host_type = document.getElementById("host_type");
        var host_co_name = document.getElementById("host_co_name").value;
        var host_no = document.getElementById("host_no").value;
        var host_ceo = document.getElementById("host_ceo").value;
        var host_zipcode = document.getElementById("host_zipcode").value;
        var host_address = document.getElementById("host_address").value;
        var host_address2 = document.getElementById("host_address2").value;
        var host_sector = document.getElementById("host_sector").value;
        var host_sector2 = document.getElementById("host_sector2").value;
        var host_bank = document.getElementById("host_bank");
        var host_bank_account = document.getElementById("host_bank_account").value;
        var host_bank_no = document.getElementById("host_bank_no").value;
        var host_file = document.getElementById("host_file").value;
        var all_agree = document.getElementById("all_agree");
        var regPw = /^[A-Za-z0-9+]*$/;
        var regPhone = /^\d{2,3}-\d{3,4}-\d{4}$/;

        if(host_id == ""){
            alert("아이디를 입력해주세요.");
            document.getElementById("host_id").focus();
            return false;
        }
        if(!emailFlag){
            alert("아이디를 인증해주세요");
            return false;
        }
        if(host_pw == ""){
            alert("비밀번호를 입력해주세요.");
            document.getElementById("host_pw").focus();
            return false;
        }
        if(host_pw.length < 6 || host_pw.length > 14){
            alert("비밀번호는 6~14자리 입력해주세요.");
            document.getElementById("host_pw").focus();
            return false;
        }
        if (!regPw.test(document.getElementById('host_pw').value)) {
            alert('비밀번호가 형식에 맞지 않습니다'); 
            document.getElementById("host_pw").focus();
             return false;
        }
        if(host_pw2 == ""){
            alert("비밀번호 확인을 입력해주세요.");
            document.getElementById("host_pw2").focus();
            return false;
        }
        if(host_pw != host_pw2){
            alert("비밀번호가 서로 일치하지 않습니다.");
            document.getElementById("host_pw2").focus();
            return false;
        }
        if(host_name == ""){
            alert("이름을 입력해주세요.");
            document.getElementById("host_name").focus();
            return false;
        }
        if(host_nickname == ""){
            alert("닉네임을 입력해주세요.");
            document.getElementById("host_nickname").focus();
            return false;
        }
        if(host_phone == ""){
            alert("연락처를 입력해주세요.");
            document.getElementById("host_phone").focus();
            return false;
        }
        if (!regPhone.test(document.getElementById('host_phone').value)) {
             alert('전화번호가 형식에 맞지 않습니다'); 
            document.getElementById("host_phone").focus();
             return false;
        }
        if(host_auth == ""){
            alert("인증번호를 입력해주세요.");
            document.getElementById("host_auth").focus();
            return false;
        }
        if(host_auth != 1234){
            alert("인증번호가 맞지 않습니다.");
            document.getElementById("host_auth").focus();
            return false;
        }
        if(host_safe_no == ""){
            alert("안심번호를 입력해주세요.");
            document.getElementById("host_safe_no").focus();
            return false;
        }
        if(host_type.options[host_type.selectedIndex].text == ""){
            alert("사업자 유형을 선택해주세요.");
            document.getElementById("host_type").focus();
            return false;
        }
        if(host_co_name == ""){
            alert("상호명을 입력해주세요.");
            document.getElementById("host_co_name").focus();
            return false;
        }
        if(host_no == ""){
            alert("사업자 등록번호를 입력해주세요.");
            document.getElementById("host_no").focus();
            return false;
        }
        if(host_ceo == ""){
            alert("대표자명을 입력해주세요.");
            document.getElementById("host_ceo").focus();
            return false;
        }
        if(host_zipcode == ""){
            alert("사업장 주소(우편번호)를 입력해주세요.");
            document.getElementById("host_zipcode").focus();
            return false;
        }
        if(host_address == ""){
            alert("사업장 주소(기본주소)를 입력해주세요.");
            document.getElementById("host_address").focus();
            return false;
        }
        if(host_address2 == ""){
            alert("사업장 주소(상세주소)를 입력해주세요.");
            document.getElementById("host_address2").focus();
            return false;
        }
        if(host_sector == ""){
            alert("업종을 입력해주세요.");
            document.getElementById("host_sector").focus();
            return false;
        }
        if(host_sector2 == ""){
            alert("업태를 입력해주세요.");
            document.getElementById("host_sector2").focus();
            return false;
        }
        if(host_bank.options[host_bank.selectedIndex].text == ""){
            alert("계좌은행을 선택해주세요.");
            document.getElementById("host_bank").focus();
            return false;
        }
        if(host_bank_account == ""){
            alert("예금주를 입력해주세요.");
            document.getElementById("host_bank_account").focus();
            return false;
        }
        if(host_bank_no == ""){
            alert("계좌번호를 입력해주세요.");
            document.getElementById("host_bank_no").focus();
            return false;
        }
        if(host_file == ""){
            alert("사업자등록증 사본을 등록해주세요.");
            document.getElementById("host_file").focus();
            return false;
        }
        if(all_agree.checked){
            return true ;
        }else{
            alert("동의를 해주세요.");
            return false;
        }
    }
 
</script>
</body>
</html>