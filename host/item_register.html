<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART BY US</title>
    
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
   
    <!-- Bootstrap 4.3.1 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Custom -->
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="/css/custom_host.css">

    <!-- Fontawesome -->
    <link rel="stylesheet" href="/css/fontawesome/css/all.min.css"><script src="/js/include.js"></script>
    <!-- Custom -->

    <script type="text/javascript" src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js"
        charset="utf-8"></script>
    <script src="/js/kakao_sdk.js"></script>

    <script>
        Kakao.init('d88bea310f4a39afbea3146fe1c0fa72');
        Kakao.isInitialized();
    </script>

    <script src="js/custom.js"></script>

    <!-- Fontawesome -->
    <link rel="stylesheet" href="css/fontawesome/css/all.min.css">
</head>

<body>
    <modal include-html="/include/header.html"></modal>
    <div class="py-md-3 px-5 py-2 text-center text-white bg-deep-dark top-notice">
        <span class="font-weight-light">코로나19에 대한 아트바이어스의 대책 및 환불 정책에 대한 최신 정보를 확인하세요.</span>
        <a href="#x" class="text-white d-lg-inline-block d-block">자세히 알아보기</a>
    </div>

    <!-- 헤더부분 네비게이션 바-->
    <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-1">
        <div class="container">
            <!--네비게이션 바 버튼-->
            <a class="navbar-brand" href="/host/index.html"><img src="http://artbyus.co.kr/img/us-partner-logo.png"
                srcset="http://artbyus.co.kr/img/us-partner-logo@2x.png 2x, http://artbyus.co.kr/img/us-partner-logo@3x.png 3x"></a>
            
            <button class="navbar-toggler border-0 font-size-md text-dark" type="button" data-toggle="collapse"
                data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarNavDropdown"></div>
        </div>
    </nav>
    <script src="/js/header.js"></script>


    <main role="main">
        <div class="container overflow-hidden my-md-5 my-4 px-md-0">
            <!-- 등록 프로세스 : min-width 992에서 글자 줄바꿈 현상 때문에 모바일에선 해당 스텝 글자만 출력-->
            <div id="registerProcess"></div>

            <!-- 카테고리 : 기본 6개씩 출력 -->
            <h3 class="mb-md-4 mb-3">카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">1개만 선택 가능합니다.</span></h3>
            <div class="row host-register-items mb-md-5 mb-4">
                <div class="col-lg-2 col-md-3 col-4">
                    <label class="radio-items">
                        <input type="radio" name="category" value="studio" checked="checked">
                        <span>스튜디오</span>
                    </label>
                </div>
                <div class="col-lg-2 col-md-3 col-4">
                    <label class="radio-items">
                        <input type="radio" name="category" value="class">
                        <span>클래스</span>
                    </label>
                </div>
                <div class="col-lg-2 col-md-3 col-4">
                    <label class="radio-items">
                        <input type="radio" name="category" value="perform">
                        <span>퍼포먼스</span>
                    </label>
                </div>
                <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                    <label class="radio-items">
                        <input type="radio" name="category" value="audition">
                        <span>오디션</span>
                    </label>
                </div>
                <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                    <label class="radio-items">
                        <input type="radio" name="category" value="store">
                        <span>스토어</span>
                    </label>
                </div>
            </div>

            <!-- 세부 카테고리 : 기본 6개씩 출력 -->
            <div id="studio" class="category-depth">
                <h3 class="mb-md-4 mb-3">세부 카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">최대 2개까지 선택 가능 합니다.</span></h3>
                <div class="row host-register-items mb-md-5 mb-4">
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="무용1">
                            <span>무용</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="연기1">
                            <span>연기</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="음악1">
                            <span>음악</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="보컬1">
                            <span>보컬</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="댄스1">
                            <span>댄스</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="녹음스튜디오">
                            <span>녹음 스튜디오</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="촬영스튜디오">
                            <span>촬영 스튜디오</span>
                        </label>
                    </div>
                </div>
            </div>

            <div id="class" class="category-depth" style="display: none">
                <h3 class="mb-md-4 mb-3">세부 카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">1개만 선택 가능 합니다.</span></h3>
                <div class="row host-register-items mb-md-5 mb-4">
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="무용2">
                            <span>무용</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="연기2">
                            <span>연기</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="음악2">
                            <span>음악</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="보컬2">
                            <span>보컬</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="댄스2">
                            <span>댄스</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="그외1">
                            <span>그 외</span>
                        </label>
                    </div>
                </div>
            </div>

            <div id="perform" class="category-depth" style="display: none">
                <h3 class="mb-md-4 mb-3">세부 카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">1개만 선택 가능 합니다.</span></h3>
                <div class="row host-register-items mb-md-5 mb-4">
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="뮤지컬1">
                            <span>뮤지컬</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="콘서트">
                            <span>콘서트</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="연극">
                            <span>연극</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="클래식무용">
                            <span>클래식/무용</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="스튜디오">
                            <span>스튜디오</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="그외2">
                            <span>그 외</span>
                        </label>
                    </div>
                </div>
            </div>

            <div id="audition" class="category-depth" style="display: none">
                <h3 class="mb-md-4 mb-3">세부 카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">1개만 선택 가능 합니다.</span></h3>
                <div class="row host-register-items mb-md-5 mb-4">
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="무용3">
                            <span>무용</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="연기3">
                            <span>연기</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="뮤지컬2">
                            <span>뮤지컬</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="음악3">
                            <span>음악</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="보컬3">
                            <span>보컬</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-lg-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="댄스3">
                            <span>댄스</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="그외3">
                            <span>그 외</span>
                        </label>
                    </div>
                </div>
            </div>

            <div id="store" class="category-depth" style="display: none">
                <h3 class="mb-md-4 mb-3">세부 카테고리를 선택해 주세요<span class="d-lg-inline-block d-block text-light-gray font-weight-light ml-lg-3 ml-0 mt-lg-0 mt-3 font-size-s">최대 2개까지 선택 가능 합니다.</span></h3>
                <div class="row host-register-items mb-md-5 mb-4">
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="교육">
                            <span>교육</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="공연관련">
                            <span>공연관련</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="용품제작">
                            <span>용품제작</span>
                        </label>
                    </div>
                    <div class="col-lg-2 col-md-3 col-4 mt-md-0 mt-3">
                        <label class="checkbox-items">
                            <input type="checkbox" name="category_depth" value="그외4">
                            <span>그 외</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- 다음단계 : 카테고리에 따라 링크 변경 -->
            <a href="javascript:goNext();" class="btn bg-yellow btn-block rounded-0 py-lg-4 py-3 mt-lg-5 mt-3 font-size-m next-link">다음으로 이동</a>
    </main>

    <footer include-html="/include/footer.html"></footer>

    <script src="/js/naver_login.js"></script>
    <script src="/js/login.js"></script>

    <script>includeHTML({});</script>
    <script>login_header();</script>

    <script type="text/javascript">

        $(document).ready(function (){
            s_key = urlParam("key");
            $('input:radio[name=category]:input[value=' + urlParam("category") + ']').attr("checked", true);
            $("#studio").hide();
            $("#"+urlParam("category")).show();

            if(s_key == null){
                var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function() {
                        if (xhr.readyState === xhr.DONE) { 
                            if (xhr.status === 200 || xhr.status === 201) {
                                var result = JSON.parse(xhr.responseText);
                                setCookie("s3_id",result[0].obj_key,1);
                                s_key = result[0].obj_key;
                            } else {
                                alert("등록이 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                                console.error(xhr.responseText);
                            }
                        }else{
                            
                        }
                    };
                    xhr.open('POST', 'http://3.34.150.116:3000/studio/create',true);
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    xhr.send("user_id=jmnu1203");
                    // xhr.send("user_id="+sessionStorage.getItem("id"));
            }else{
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === xhr.DONE) { 
                        if (xhr.status === 200 || xhr.status === 201) {
                            var result = JSON.parse(xhr.responseText);
                            $("input[name=category][value="+result[0].obj_category+"]").prop("checked",true);
                            $("#studio").hide();
                            $("#"+result[0].obj_category).show(); 
                            var arrDay = result[0].obj_sub.split(',');
                            $("input[name=category_depth]").prop('checked', false);
                            for (var nArrCnt in arrDay) {
                                $("input[name=category_depth][value="+arrDay[nArrCnt]+"]").prop("checked",true);
                                console.log($("#"+result[0].obj_category).children("input[name=category_depth][value="+arrDay[nArrCnt]+"]"))
                            }
                        } else {
                            alert("정보를 불러오던 중 오류가 발생했습니다. 다시 시도해주세요.");
                            console.error(xhr.responseText);
                        }
                    }else{
                        
                    }
                };
                xhr.open('POST', 'http://3.34.150.116:3000/studio/mod',true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.send("studio_key="+s_key);
            }
        });

        function onLogout() {
            sessionStorage.clear();
            location.href = "index.html";
        }

        var urlParam = function(name){
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
            if (results==null){
                return null;
            }
            else{
                return results[1] || 0;
            }
        }
        $('input[name=category]').on('change', function (e) {
            $("input[name='category_depth']").prop('checked',false);
        });

        $('input[name=category_depth]').on('change', function (e) {
            switch($("input[name='category']:checked").val()){
                case "studio":
                case "store":{
                    console.log($("input[name='category_depth']:checked"));
                    if ($("input[name='category_depth']:checked").length > 2) {
                        $(this).prop('checked', false);
                        alert("최대 2개까지 선택 가능합니다.");
                    }else if($("input[name='category_depth']:checked").length <= 0 ){
                        $('#go_next').prop('checked', false);
                    }
                    break;
                }
                case "audition":
                case "class":
                case "perform":{
                    if ($("input[name='category_depth']:checked").length > 1) {
                        $(this).prop('checked', false);
                        alert("최대 1개까지 선택 가능합니다.");
                    }else if($("input[name='category_depth']:checked").length <= 0 ){
                        $('#go_next').prop('checked', false);
                    }
                    break;
                }

            }
        });

        function goNext(){
            var category = document.getElementsByName("category");
            var category_depth = document.getElementsByName("category_depth");
            var cateText = "";
            var cateDepText = [];
            for(var i = 0;i<category.length;i++){
                if(category[i].checked){
                    cateText = category[i].value;
                    break;
                }
            }
            
            for(var i=0;i<category_depth.length;i++){
                if(category_depth[i].checked){
                    cateDepText.push(category_depth[i].value);
                }
            }

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === xhr.DONE) { 
                    if (xhr.status === 200 || xhr.status === 201) {
                        var loc = $("input[name='category']:checked").val();
                        window.location.href = "/host/"+loc+"_register2.html?key="+s_key;
                    } else {
                        alert("등록이 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                        console.error(xhr.responseText);
                    }
                }else{
                }
            }
            
            xhr.open('POST', 'http://3.34.150.116:3000/studio/apply/category',true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send("key="+getCookie("s3_id")+"&category="+cateText+"&category_depth="+cateDepText); 
        }

        var setCookie = function(name, value, day) {
            var date = new Date();
            date.setTime(date.getTime() + day * 60 * 60 * 24 * 1000);
            document.cookie = name + '=' + value + ';expires=' + date.toUTCString() + ';path=/';
        };

        var getCookie = function(name) {
            var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
            return value? value[2] : null;
        };

    </script>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <script src="/js/include_html_host.js"></script>
    <!-- <script src="/js/custom.js"></script> -->
</body>

</html>