<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART BY US</title>

     <!-- Bootstrap 4.3.1 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="/css/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/css/custom_host.css">

    <!-- Custom -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js" charset="utf-8"></script>
    <script src="/js/kakao_sdk.js"></script>
    <script src="/js/include.js"></script>
    
    <script>
        Kakao.init('d88bea310f4a39afbea3146fe1c0fa72');
        Kakao.isInitialized();
    </script>
   
</head>

<body>
    <div id="modals"></div>
    <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-1">
        <div class="container">
            <a class="navbar-brand" href="/host/index.html"><img src="http://artbyus.co.kr/img/us-partner-logo.png"
                    srcset="http://artbyus.co.kr/img/us-partner-logo@2x.png 2x, http://artbyus.co.kr/img/us-partner-logo@3x.png 3x"></a>
            <div class="ml-auto align-items-center d-lg-none d-flex">
                <a class="text-dark mr-3 font-size-sm" href="/member/calendar.html"><i
                        class="far fa-calendar-alt"></i></a>
                <a class="text-dark mr-3 font-size-sm" href="/member/recent_list.html"><i
                        class="far fa-clock"></i></a>
                <a class="text-dark mr-2 font-size-sm" href="/member/purchase.html"><i
                        class="fas fa-shopping-cart"></i></a>
            </div>
            <button class="navbar-toggler border-0 font-size-md text-dark" type="button" data-toggle="collapse"
                data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarNavDropdown"></div>
        </div>
    </nav>
    <script src="/js/header_host.js"></script>


    <main role="main">
        <div class="container my-md-5 my-4">
            <h2>광고 신청하기</h2>
        </div>

        <!-- 광고 슬라이드 -->
        <div id="carouselSlide"></div>

        <!-- 리스트 -->
        <div class="container py-3">
            <!-- 검색 및 정렬 -->
            <div class="d-lg-flex mb-3 custom-inputs-sub host-top-function">
                <div class="input-group search-bar-solid">
                    <input type="text" id="searchText" class="form-control text-dark search-text" placeholder="공간명을 검색해주세요">
                    <div class="input-group-append">
                        <button type="button" onclick="goSearch();" class="btn bg-yellow text-gray">검색</button>
                    </div>
                </div>

                <div class="d-flex mt-3 mt-lg-0">
                    <button type="button" class="btn font-weight-light bg-yellow mx-lg-3 mr-3 text-btn" data-title="data"
                            data-toggle="modal" onclick="putInside('platinum');" data-target="#applyAdModal">플래티넘 광고 신청</button>
                    <button type="button" class="btn font-weight-light bg-yellow text-btn" data-title="data"
                            data-toggle="modal" onclick="putInside('prime');" data-target="#applyAdModal">프라임 광고 신청</button>
                </div>
            </div>

            <!-- 리스트 -->
            <ul id="std_list" class="list-group host-item-list calc">
                
            </ul>
        </div>
    </main>

    <!-- 광고 신청 모달 -->
    <div class="modal fade" id="applyAdModal" tabindex="-1" role="dialog" aria-labelledby="applyAdModalLabel" aria-hidden="true">
        <div class="modal-dialog custom-modal" role="document">
            <div class="modal-content px-0 py-lg-5 py-5 text-center">
                <div class="modal-header p-0 mb-md-4 mb-3 border-0">
                    <h2 class="modal-title mx-auto" id="applyAdModalLabel">프라임 광고 신청하기</h2>
                </div>
                <!-- 신청 정보 -->
                <div class="modal-body p-0">
                    <!-- 광고 대상 -->
                    <div class="modal-full-img d-flex justify-content-center align-items-center">
                        <img id="modal_profile" src=studio.studio_thumbnail class="w-100">
                    </div>

                    <!-- 광고 정보 -->
                    <div class="px-lg-5 px-4 mt-3 mb-5 text-left">
                        <h4 id="modal_name"></h4>
                        <p id= "modal_subname" class="font-size-xs font-weight-light text-light-gray"></p>
                        <div class="font-size-xs font-weight-light">
                            <p class="mr-md-4 mr-2 d-inline-block mb-0">
                                <i class="fas fa-heart text-red"></i>
                                <span class="ml-1" id="modal_studio_like"></span>
                            </p>
                            <span id="modal_type" class="mr-md-4 mr-2"></span>
                            <span id="modal_price"></span>
                        </div>
                    </div>

                    <p class="font-size-s">위 연습실에 대한 광고신청을 진행합니다.</p>

                    <div class="custom-inputs px-4">
                        <button type="button" onclick="apply()" class="btn bg-yellow w-lg-65 w-100 py-md-4 py-2 h-auto rounded-0 font-size-s"
                                data-toggle="modal" data-target="#applyAdResultModal" data-dismiss="modal">프라임 광고 신청</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- 서브 푸터 -->
    <footer include-html="/include/footer.html"></footer>

    <script src="/js/naver_login.js"></script>
    <script src="/js/login.js"></script>
    <script src="/js/custom.js"></script>

    <script>includeHTML({});</script>
    <script>login_header();</script>
    <script src="../js/include_html_host.js"></script>

    <script>
        var studioList = [];
        var stu_key = "";d
        var ad_type = "";
        function goSearch(){
            var tempList = [];
            var searchText = $("#searchText").val();
            for(var i=0;i<studioList.length;i++){
                var studio_temp = studioList[i];
                if(studio_temp.studio_name.indexOf(searchText) == 0){
                    tempList.push(studio_temp);
                }
            }
            $("#std_list").empty();
            writeList(tempList);
        }

        var writeList = function(tempList){
            for(var i = 0; i<tempList.length;i++){
                var studio_temp = tempList[i];
                var studio = '<li class="list-group-item p-3 mb-3 border">'
                                +'<div id="border'+i+'" class="row align-items-center">'
                                    +'<div class="col-lg-10">'
                                        +'<div class="d-flex align-items-lg-center">'
                                            +'<div class="d-flex justify-content-center align-items-center overflow-hidden mr-4 item-thumbs">'
                                                +'<img src="'+studio_temp.studio_thumbnail+'" class="align-self-center h-100" alt="">'
                                            +'</div>'
                                            +'<div class="item-texts">'
                                                +'<a href="/sub/studio_view.html" class="text-decoration-none">'
                                                    +'<h4 class="text-gray">'+studio_temp.studio_name
                                                        +'<p class="font-size-xs ml-lg-3 ml-2 d-inline-block mb-1 align-middle">'
                                                            +'<i class="fas fa-heart text-red"></i>'
                                                            +'<span class="ml-1">'+studio_temp.studio_like+'</span>'
                                                        +'</p>'
                                                    +'</h4>'
                                                +'</a>'
                                                +'<p class="font-weight-light text-light-gray mb-2">'+studio_temp.studio_subname+'</p>'
                                                +'<p class="font-weight-light mb-0"><span class="mr-md-4">예약유형 : '+studio_temp.studio_types+ '</span>'
                                                +'<span class="d-md-inline-block d-block">'+studio_temp.studio_price+'원 / 시간</span></p>'
                                            +'</div>'
                                        +'</div>'
                                    +'</div>'
                                    +'<div class="col-lg-2">'
                                        +'<div class="text-lg-center text-right mt-lg-0 mt-3 host-menu">'
                                            +'<button type="button" id="only_one'+i+'" onclick="is_block('+i+','+studio_temp.studio_key+','+tempList.length+');" class="btn border mr-lg-0 mr-2 item-btn item-pick">선택하기</button>'
                                        +'</div>'
                                    +'</div>'
                                +'</div>'
                            +'</li>';
                $("#std_list").append(studio);
            }
        }

        function is_block(num, key, length){
            stu_key = key;
            for(var i = 0;i<length;i++){
                if(i == num){
                    $("#only_one"+i).attr('class','btn border mr-lg-0 mr-2 item-btn item-pick');
                    // $("#border"+i).attr('class','#ffde3b solid 2px');
                }else{
                    $("#only_one"+i).attr('class','btn border mr-lg-0 mr-2 item-btn');
                    // $("#border"+i).attr('outline',none);
                }
            }

            $("#modal_profile").attr("src",studioList[num].studio_thumbnail);
            $("#modal_name").text(studioList[num].studio_name);
            $("#modal_subname").text(studioList[num].studio_subname);
            $("#modal_studio_like").text(studioList[num].studio_like);
            $("#modal_type").text("예약유형 : "+studioList[num].studio_types);
            $("#modal_price").text(studioList[num].studio_price+" / 시간");
        }

        $(document).ready(function (){
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === xhr.DONE) { 
                    if (xhr.status === 200 || xhr.status === 201) {
                        studioList = JSON.parse(xhr.responseText);
                        writeList(studioList);
                    } else {
                        alert("목록이 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                        console.error(xhr.responseText);
                    }
                }else{
                    
                }
            };
            xhr.open('POST', 'http://3.34.150.116:3000/studio/host',true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send("user_id=jmnu1203");
            // xhr.send("user_id="+sessionStorage.getItem("id"));

        });

        function apply(){
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === xhr.DONE) { 
                    if (xhr.status === 200 || xhr.status === 201) {
                    } else {
                        alert("삭제가 정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
                        console.error(xhr.responseText);
                    }
                }else{
                }
            };
            xhr.open('POST', 'http://3.34.150.116:3000/ad/apply',true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send("key="+stu_key+"&type=studio&ad_type="+ad_type);
        }

        function putInside(ad_type_txt){
            ad_type = ad_type_txt;
        }
    </script>
</body>

</html>